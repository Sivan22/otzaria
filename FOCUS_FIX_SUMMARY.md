# תיקון בעיית הפוקוס בכרטיסיית החיפוש

## הבעיה
לאחר חיפוש במסך הראשי, כאשר המשתמש לוחץ על אחד התוצאות ונפתח חלון חדש, ואז חוזר לכרטיסייה של החיפוש, הסמן לא ממוקד בתיבת הטקסט.

## הפתרון
נוספו מספר מנגנונים להבטחת החזרת הפוקוס לשדה החיפוש:

### 1. מאזין לשינויי כרטיסיות (`TabsBloc`)
- מאזין לאירוע `SetCurrentTab` ומבקש פוקוס כשכרטיסיית החיפוש הופכת לפעילה
- זה הפתרון העיקרי לבעיה המתוארת

### 2. מאזין למחזור חיי האפליקציה (`WidgetsBindingObserver`)
- מבקש פוקוס כשהאפליקציה חוזרת למצב פעיל (`AppLifecycleState.resumed`)
- מטפל במקרים שבהם המשתמש עובר לאפליקציה אחרת וחוזר

### 3. מאזין לאירועי מקלדת (`KeyboardListener`)
- מזהה שימוש בקיצורי מקלדת למעבר בין כרטיסיות (`Ctrl+Tab`)
- מבקש פוקוס אחרי מעבר בכרטיסיות באמצעות מקלדת

### 4. מאזין לאירועי עכבר (`GestureDetector`)
- מבקש פוקוס כשהמשתמש לוחץ בכל מקום במסך החיפוש

### 5. מאזין לשינויי מטריקות חלון (`didChangeMetrics`)
- מטפל במקרים נוספים של שינוי מצב החלון

### 6. שיפור בתוצאות החיפוש
- מבקש פוקוס חזרה לשדה החיפוש אחרי לחיצה על תוצאת חיפוש

## קבצים שהשתנו
- `lib/search/view/tantivy_full_text_search.dart` - הפתרון העיקרי
- `lib/search/view/tantivy_search_results.dart` - שיפור נוסף

## עיכובים זמניים
נוספו עיכובים שונים כדי להבטיח שהUI מוכן לקבלת פוקוס:
- 100ms - עיכוב בסיסי לרינדור UI
- 200ms - לשינויי מטריקות חלון
- 300ms - למעבר בין כרטיסיות
- 400ms - לקיצורי מקלדת
- 500ms - לחזרה מאפליקציה אחרת

## בדיקות
הקוד נבדק עם `flutter analyze` ועבר בהצלחה ללא שגיאות.